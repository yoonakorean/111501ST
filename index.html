<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>10-1 å¥å­å¡«ç©ºæŒ‘æˆ°</title>
<style>
body { font-family: sans-serif; max-width: 600px; margin: auto; text-align: center; padding: 30px 15px; }
#logo, #logo-game { width: 150px; max-width: 80%; margin-bottom: 10px; display: block; margin-left: auto; margin-right: auto; }
#game-title { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
#mode-select button, button { display: block; width: 80%; max-width: 300px; margin: 10px auto; padding: 12px 20px; font-size: 16px; cursor: pointer; text-align: center; }
#check-btn, #next-btn, #submit-btn, #restart-btn, #mode-reselect-btn { width: 150px; }
.hidden { display: none; }
.fill-input { width: 120px; padding: 5px; font-size: 16px; text-align:center; }
.question-ko { font-size: 20px; margin: 15px 0; }
.question-zh { font-size:20px; font-weight:bold; margin-bottom: 10px; color:#333; }
audio { width: 100%; max-width: 400px; margin-top: 10px; display:block; margin-left:auto; margin-right:auto;}
#completion-note-practice, #completion-note-challenge { margin-top: 10px; font-size: 16px; color: #555; }

/* æ”¹å‹•äºŒï¼šæ”¾å¤§ç½®ä¸­è¼¸å…¥æ¡† */
#nickname { 
  font-size: 20px; 
  padding: 10px; 
  width: 80%; 
  max-width: 350px; 
  text-align: center; 
  display:block; 
  margin: 10px auto; 
}
</style>
</head>
<body>

<script>
var password = prompt("è«‹è¼¸å…¥å¯†ç¢¼æ‰èƒ½é€²å…¥æ­¤ç¶²ç«™ï¼š");
if (password !== "1231") { alert("å¯†ç¢¼éŒ¯èª¤ï¼Œç„¡æ³•é€²å…¥ï¼"); window.location.href = "https://www.google.com"; }
</script>

<div id="mode-select">
<img id="logo" src="logo.png" alt="Logo" />
<h2>è«‹é¸æ“‡æ¨¡å¼</h2>
<button id="mode-practice-btn">ç·´ç¿’æ¨¡å¼ï¼ˆç„¡æ™‚é–“é™åˆ¶ï¼‰</button>
<button id="mode-challenge-btn">æŒ‘æˆ°æ¨¡å¼ï¼ˆé™æ™‚ï¼‰</button>
<p style="font-size:14px; color:#555; margin-top:10px;">å…©ç¨®æ¨¡å¼çš†å¯é‡è¤‡ç·´ç¿’ï½</p>
</div>

<div id="game-area" class="hidden">
<img id="logo-game" src="logo.png" alt="Logo"/>
<div id="game-title">10-1 å¥å­å¡«ç©ºæŒ‘æˆ°</div>
<div id="question-number"></div>
<div id="timer" style="font-size:18px; color:red; margin-bottom:15px;"></div>
<div class="question-zh" id="question-ch"></div>
<div class="question-ko" id="question-ko"></div>
<div id="result" style="min-height: 60px; margin-top: 10px;"></div>
<button id="check-btn" disabled>ç¢ºèª</button>
<button id="next-btn" style="display:none;">ä¸‹ä¸€é¡Œ</button>
</div>

<div id="nickname-section" class="hidden" style="margin-top:20px;">
<div id="completion-title" style="font-size:20px; margin-bottom:10px; color:#333;"></div>
<input type="text" id="nickname" placeholder="è«‹è¼¸å…¥å§“åï¼‹ç”Ÿæ—¥( ç¯„ä¾‹ï¼šç‹å°æ˜0828 )" />
<div id="completion-note-practice" class="hidden" style="text-align:center; color:#555;"></div>
<div id="completion-note-challenge" class="hidden" style="text-align:center; color:#555;"></div>
<button id="submit-btn" disabled>æäº¤æˆç¸¾</button>
<button id="restart-btn">é‡æ–°é–‹å§‹</button>
<button id="mode-reselect-btn" style="margin-top:10px;">é‡æ–°é¸æ“‡æ¨¡å¼</button>
</div>

<script>
const questions = [
{ audio: "11100101S.mp3", question: "ï¼¿ï¼¿ì´ ë§ìŠµë‹ˆë‹¤.", answer: "ì˜·", full: "ì˜·ì´ ë§ìŠµë‹ˆë‹¤.", chinese: "è¡£æœå¾ˆå¤šã€‚" },
{ audio: "11100102S.mp3", question: "ï¼¿ï¼¿ê°€ ì‰½ë‹ˆë‹¤.", answer: "í• ë¨¸ë‹ˆ", full: "í• ë¨¸ë‹ˆê°€ ì‰½ë‹ˆë‹¤.", chinese: "å¥¶å¥¶ä¼‘æ¯ã€‚" },
{ audio: "11100103S.mp3", question: "ï¼¿ï¼¿ê°€ ë§µìŠµë‹ˆë‹¤.", answer: "ë–¡ë³¶ì´", full: "ë–¡ë³¶ì´ê°€ ë§µìŠµë‹ˆë‹¤.", chinese: "è¾£ç‚’å¹´ç³•å¾ˆè¾£ã€‚" },
{ audio: "11100104S.mp3", question: "ï¼¿ï¼¿ê°€ ê·€ì—½ìŠµë‹ˆë‹¤.", answer: "ê°•ì•„ì§€", full: "ê°•ì•„ì§€ê°€ ê·€ì—½ìŠµë‹ˆë‹¤.", chinese: "ç‹—ç‹—å¾ˆå¯æ„›ã€‚" },
{ audio: "11100105S.mp3", question: "ï¼¿ï¼¿ì´ ìœ ëª…í•©ë‹ˆë‹¤.", answer: "í•œêµ­ ì•„ì´ëŒ", full: "í•œêµ­ ì•„ì´ëŒì´ ìœ ëª…í•©ë‹ˆë‹¤.", chinese: "éŸ“åœ‹å¶åƒå¾ˆæœ‰åã€‚" },
{ audio: "11100106S.mp3", question: "ï¼¿ï¼¿ê°€ ì˜ˆì©ë‹ˆë‹¤.", answer: "ì›í”¼ìŠ¤", full: "ì›í”¼ìŠ¤ê°€ ì˜ˆì©ë‹ˆë‹¤.", chinese: "æ´‹è£å¾ˆæ¼‚äº®ã€‚" },
{ audio: "11100107S.mp3", question: "ï¼¿ï¼¿ì´ í½ë‹ˆë‹¤.", answer: "ì‹ ë°œ", full: "ì‹ ë°œì´ í½ë‹ˆë‹¤.", chinese: "é‹å­å¾ˆå¤§ã€‚" },
{ audio: "11100108S.mp3", question: "ï¼¿ï¼¿ì´ ë§ì´ ë¨¹ìŠµë‹ˆë‹¤.", answer: "í˜•", full: "í˜•ì´ ë§ì´ ë¨¹ìŠµë‹ˆë‹¤.", chinese: "å“¥å“¥åƒå¾ˆå¤šã€‚(ç”·ç”Ÿç¨±å‘¼)" },
{ audio: "11100109S.mp3", question: "ï¼¿ï¼¿ì´ ë” ë¹ ë¦…ë‹ˆê¹Œ?", answer: "ì§€í•˜ì² ", full: "ì§€í•˜ì² ì´ ë” ë¹ ë¦…ë‹ˆê¹Œ?", chinese: "åœ°éµæ›´å¿«å—ï¼Ÿ" },
{ audio: "11100110S.mp3", question: "ï¼¿ï¼¿ê°€ ì¢‹ìŠµë‹ˆë‹¤.", answer: "ë‚ ì”¨", full: "ë‚ ì”¨ê°€ ì¢‹ìŠµë‹ˆë‹¤.", chinese: "å¤©æ°£å¾ˆå¥½ã€‚" },
{ audio: "11100111S.mp3", question: "ï¼¿ï¼¿ì´ ë§ì´ ì—†ìŠµë‹ˆë‹¤", answer: "ì‹œê°„", full: "ì‹œê°„ì´ ë§ì´ ì—†ìŠµë‹ˆë‹¤", chinese: "æ²’æœ‰å¾ˆå¤šæ™‚é–“ã€‚" },
{ audio: "11100112S.mp3", question: "ï¼¿ï¼¿ê°€ ì‘ìŠµë‹ˆë‹¤.", answer: "ì‚¬ì´ì¦ˆ", full: "ì‚¬ì´ì¦ˆê°€ ì‘ìŠµë‹ˆë‹¤.", chinese: "å°ºå¯¸å¾ˆå°ã€‚" }
];

const modeSelectDiv=document.getElementById("mode-select");
const gameAreaDiv=document.getElementById("game-area");
const questionNumberDiv=document.getElementById("question-number");
const questionChDiv=document.getElementById("question-ch");
const questionKoDiv=document.getElementById("question-ko");
const resultDiv=document.getElementById("result");
const checkBtn=document.getElementById("check-btn");
const nextBtn=document.getElementById("next-btn");
const nicknameSection=document.getElementById("nickname-section");
const completionTitle=document.getElementById("completion-title");
const nicknameInput=document.getElementById("nickname");
const submitBtn=document.getElementById("submit-btn");
const restartBtn=document.getElementById("restart-btn");
const modeReselectBtn=document.getElementById("mode-reselect-btn");
const completionNotePractice=document.getElementById("completion-note-practice");
const completionNoteChallenge=document.getElementById("completion-note-challenge");

let shuffledQuestions=[],current=0,correct=0,finalScore=0;
let timer=null,timeLeft=0,timerStarted=false,currentMode=null,startTime=null;

// é¡¯ç¤ºæ¨™é¡Œèˆ‡é€è¡¨å–®æ¨™é¡Œ
const displayTitle = "10-1 å¥å­å¡«ç©ºæŒ‘æˆ°";
const fullTitle = "11-10-1 å¥å­å¡«ç©ºæŒ‘æˆ°";

function shuffle(array){for(let i=array.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[array[i],array[j]]=[array[j],array[i]];}return array;}

function showModeSelect(){
  modeSelectDiv.style.display="block";
  gameAreaDiv.classList.add("hidden");
  nicknameSection.classList.add("hidden");
  resetGameVars();
}

function showGameArea(){
  modeSelectDiv.style.display="none";
  gameAreaDiv.classList.remove("hidden");
  nicknameSection.classList.add("hidden");
  document.getElementById("game-title").textContent=displayTitle;
  if(currentMode==="challenge"){
    timeLeft=shuffledQuestions.length*30;
    document.getElementById("timer").textContent=`å‰©é¤˜æ™‚é–“ï¼š${timeLeft} ç§’`;
    document.getElementById("timer").style.display="block";
  } else {
    document.getElementById("timer").style.display="none";
  }
  startTime=Date.now();
}

function resetGameVars(){
  clearInterval(timer); timer=null; timerStarted=false; timeLeft=0;
  current=0; correct=0; finalScore=0;
  submitBtn.disabled=true; resultDiv.innerHTML="";
  questionNumberDiv.textContent="";

   // ğŸ”¥ é¡å¤–è£œå……ï¼Œé¿å…æŒ‰éˆ•æ¶ˆå¤±
  checkBtn.style.display="inline-block"; 
  checkBtn.disabled=true;
  nextBtn.style.display="none";
}

function loadQuestion(){
  if(shuffledQuestions.length===0){shuffledQuestions=shuffle([...questions]);}
  if(current>=shuffledQuestions.length){endGame();return;}
  const q=shuffledQuestions[current];
  questionNumberDiv.textContent=`ç¬¬ ${current+1} é¡Œ / å…± ${shuffledQuestions.length} é¡Œ`;
  // æ”¹å‹•ä¸€ï¼šé¡Œç›®ä¸­æ–‡é¡¯ç¤º
  questionChDiv.textContent="ğŸ“˜ é¡Œç›®ï¼š" + q.chinese;
  // å‹•æ…‹æ’å…¥ input
  const parts=q.question.split("ï¼¿ï¼¿");
  let html="";
  for(let i=0;i<parts.length;i++){
    html+=parts[i];
    if(i<parts.length-1){
      html+=`<input type="text" class="fill-input" id="fill-${i}" />`;
    }
  }
  questionKoDiv.innerHTML=html;
  resultDiv.innerHTML="";
  checkBtn.disabled=true; nextBtn.style.display="none";

  document.querySelectorAll(".fill-input").forEach(inp=>{
    inp.addEventListener("input",()=>{checkBtn.disabled=[...document.querySelectorAll(".fill-input")].some(x=>x.value.trim()==="");});
  });

  // æ”¹å‹•ä¸‰ï¼šç·´ç¿’æ¨¡å¼è£œä¸ŠæŒ‰éˆ•
  if(currentMode==="practice"){
    checkBtn.style.display="inline-block";
    nextBtn.style.display="none";
  }
}

function startTimer(){
  if(timerStarted||currentMode==="practice")return;
  timerStarted=true; if(timeLeft<=0)timeLeft=shuffledQuestions.length*30;
  timer=setInterval(()=>{
    timeLeft--;
    document.getElementById("timer").textContent=`å‰©é¤˜æ™‚é–“ï¼š${timeLeft} ç§’`;
    if(timeLeft<=0){clearInterval(timer); endGame();}
  },1000);
}

checkBtn.addEventListener("click",()=>{
  const q=shuffledQuestions[current];
  const userAns=[...document.querySelectorAll(".fill-input")].map(x=>x.value.trim()).join(" ");
  if(userAns===q.answer){resultDiv.innerHTML=`âœ… ç­”å°äº†ï¼<br><strong>${q.full}</strong><br><audio controls src="${q.audio}"></audio>`; correct++;}
  else{resultDiv.innerHTML=`âŒ éŒ¯èª¤<br>æ­£ç¢ºç­”æ¡ˆï¼š<strong>${q.full}</strong><br><audio controls src="${q.audio}"></audio>`;}
  checkBtn.disabled=true; nextBtn.style.display="inline-block";

  // ç·´ç¿’æ¨¡å¼é¡¯ç¤ºä¸‹ä¸€é¡Œ
  if(currentMode==="practice"){
    nextBtn.style.display="inline-block";
  }
});

nextBtn.addEventListener("click",()=>{current++; loadQuestion();});

function endGame(){
  clearInterval(timer); timerStarted=false;
  finalScore=Math.round((correct/shuffledQuestions.length)*100);
  const passStatus=finalScore>=80?"âœ… åˆæ ¼ å¯é‡æ–°æŒ‘æˆ°":"âŒ ä¸åˆæ ¼ è«‹é‡æ–°æŒ‘æˆ°";
  completionTitle.textContent=`ä½ ç­”å° ${correct}/${shuffledQuestions.length} é¡Œï¼Œå¾—åˆ† ${finalScore}% - ${passStatus}`;
  nicknameSection.classList.remove("hidden");
  if(currentMode==="practice"){
    completionNotePractice.textContent="å¯é‡è¤‡ç·´ç¿’\næœ€å¾Œè¨˜å¾—åˆ°æŒ‘æˆ°æ¨¡å¼å›å‚³åˆæ ¼æˆç¸¾æ­ï¼ï¼";
    completionNotePractice.style.whiteSpace="pre-line"; completionNotePractice.classList.remove("hidden");
    completionNoteChallenge.classList.add("hidden"); nicknameInput.style.display="none"; submitBtn.style.display="none";
  } else {
    completionNotePractice.classList.add("hidden");
    completionNoteChallenge.textContent="è«‹å›å‚³åˆæ ¼æˆç¸¾æ­ï¼ï¼"; completionNoteChallenge.classList.remove("hidden");
    nicknameInput.style.display="block"; submitBtn.style.display="inline-block"; submitBtn.disabled=finalScore<80;
  }
  // æ”¹å‹•äºŒï¼šçµæŸå¾Œéš±è—æœ€å¾Œä¸€é¡Œé¡Œç›®èˆ‡ç­”æ¡ˆ
  questionChDiv.textContent=""; 
  questionKoDiv.textContent="";
  resultDiv.innerHTML="";
  checkBtn.style.display="none"; 
  nextBtn.style.display="none"; 
  document.getElementById("timer").style.display="none";
}

submitBtn.addEventListener("click",()=>{
  const nickname=nicknameInput.value.trim();
  if(!nickname||finalScore<80)return;
  const elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
  const weekdayNames=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"];
  const weekday=weekdayNames[new Date().getDay()];
  
  const formURL="https://docs.google.com/forms/d/e/1FAIpQLSd8KhDu_lq6g4aPzkLaNYUUVG9P0E9cRT1R2WVDIkkfFh7WxA/formResponse";
  const formData=new FormData();
  formData.append("entry.1082970818",nickname);
  formData.append("entry.851626887",finalScore);
  formData.append("entry.498226528",elapsedSeconds + " ç§’");
  formData.append("entry.532888754",weekday);
  formData.append("entry.1110600272",fullTitle);
  
  fetch(formURL,{method:"POST",body:formData,mode:"no-cors"})
    .then(()=>alert("æˆç¸¾å·²é€å‡ºï¼Œè¬è¬ï¼"))
    .catch(()=>alert("ç„¡æ³•é€å‡ºæˆç¸¾ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚"));
});

document.getElementById("mode-practice-btn").addEventListener("click",()=>{currentMode="practice"; shuffledQuestions=shuffle([...questions]); resetGameVars(); showGameArea(); loadQuestion();});
document.getElementById("mode-challenge-btn").addEventListener("click",()=>{currentMode="challenge"; shuffledQuestions=shuffle([...questions]); resetGameVars(); showGameArea(); loadQuestion(); startTimer();});
restartBtn.addEventListener("click",()=>{resetGameVars(); shuffledQuestions=shuffle([...questions]); showGameArea(); loadQuestion(); if(currentMode==="challenge")startTimer();});
modeReselectBtn.addEventListener("click",()=>{currentMode=null; resetGameVars(); showModeSelect();});

showModeSelect();
</script>
</body>
</html>
